<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tw-elements/dist/css/index.min.css" />
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: {
          sans: ['Inter', 'sans-serif'],
        },
      }
    }
  }
</script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css" integrity="sha512-BnbUDfEUfV0Slx6TunuB042k9tuKe3xrD6q4mg5Ed72LTgzDIcLPxg6yI2gcMFRyomt+yJJxE+zJwNmxki6/RA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Library</title>
</head>
<body>
    <nav class="flex items-center justify-between flex-wrap bg-teal-500 p-6">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
          <img src="https://sun6-20.userapi.com/s/v1/ig2/xoZWZvAAk3WGivYv_4e1NpqQebYq2ZeFC0tzybPQVy7I-D6DxyTnVlK-_hNgUtBO9PGjTcSYJKtSblGuPoWS4Szu.jpg?size=50x50&quality=96&crop=25,25,201,201&ava=1" alt="">
            <!-- <span class="font-semibold text-xl tracking-tight"> Home</span> -->
        </div>
        <div class="block lg:hidden">
          <button class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
            <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
          </button>
        </div>
        <div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto">
          <div class="text-sm lg:flex-grow">
            <a href="dashboard.html" class="text-xl block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-6">
                Home
              </a>
              <a href="mybook.html" class="text-xl block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-6">
                My Book
              </a>
            <a href="library.html" class="text-white text-xl block mt-4 lg:inline-block lg:mt-0  hover:text-dark mr-6">
              Library
            </a>
            <a href="users.html" class="text-xl block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-6">
              Users
            </a>
            <a href="setting.html" class="text-xl block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-6">
                Settings
              </a>
          </div>
          <div>
            <a href="#" id="name" class="inline-block text-sm px-4 py-2 leading-none border rounded text-white border-white hover:border-transparent hover:text-teal-500 hover:bg-white mt-4 lg:mt-0"></a>
            <a href="logout.html" class="inline-block text-sm px-4 py-2 leading-none border rounded text-white border-white hover:border-transparent hover:text-teal-500 hover:bg-white mt-4 lg:mt-0">Logout</a>
          </div>
        </div>
      </nav>

      <div class="flex justify-between m-10 border-none">
        <div class="border-2 bg-yellow-600 rounded-lg px-3 py-2 text-yellow-400 cursor-pointer hover:bg-yellow-600 hover:text-yellow-200">
           Total Books : <span id="totalBook"></span>
          </div>
       
          <a type="button" class="border-2 bg-green-600 rounded-lg px-3 py-2 text-green-400 cursor-pointer hover:bg-green-600 hover:text-green-200" data-bs-toggle="modal" data-bs-target="#exampleModal">
      <i class="fa fa-plus-circle" aria-hidden="true"></i> Add Books 
        </a>
       
      </div>

     

      <div class="flex flex-col mx-10">
        <div class="overflow-x-auto sm:-mx-6 lg:-mx-8">
          <div class="py-2 inline-block min-w-full sm:px-6 lg:px-8">
            <div class="overflow-hidden">
              <table class="min-w-full text-center">
                <thead class="border-b bg-gray-800 ">
                  <tr>
                    <th scope="col" class="text-sm font-medium text-white px-6 py-4">
                      Name
                    </th>
                    <th scope="col" class="text-sm font-medium text-white px-6 py-4">
                      Title
                    </th>
                    <th scope="col" class="text-sm font-medium text-white px-6 py-4">
                      Price
                    </th>
                    <th scope="col" class="text-sm font-medium text-white px-6 py-4">
                        Action
                    </th>
                  </tr>
                </thead>
                <tbody id="tbl">
                 
                 
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- popup form code -->





<!-- Modal for add Book-->
<div class="modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto"
  id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog relative w-auto pointer-events-none">
    <div
      class="modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current">
      <div
        class="modal-header flex flex-shrink-0 items-center justify-between p-4 border-b border-gray-200 rounded-t-md">
        <h5 class="text-xl font-medium leading-normal text-gray-800" id="exampleModalLabel">Add Book Here</h5>
        <button type="button"
          class="btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline"
          data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body relative p-4">
        <section class="gradient-form bg-gray-200 ">
          <div class="container py-5 px-6 ">
            <div
              class="flex justify-center items-center flex-wrap  g-6 text-gray-800"
            >
              <div class="md:p-12 md:mx-6 bg-white">
                <div class="text-center">
                  <img
                    class="mx-auto w-48"
                    src="book.jpg"
                    alt="logo"
                  />
                  <h4 class="text-xl font-semibold mt-1 mb-6 pb-1">
                    Welcome To Our Library
                  </h4>
                </div>
                <form id="bookForm">    
                  <div class="mb-4">
                    <input
                      type="text"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="book_name"
                      placeholder="Name"
                    />
                  </div>
                  <div class="mb-4">
                    <input
                      type="title"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="book_title"
                      placeholder="Title"
                    />
                  </div>
                  <div class="mb-4">
                    <input
                      type="price"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="book_price"
                      placeholder="Price"
                    />
                  </div>
                  <div class="text-center pt-1 mb-12 pb-1">
                 
                  </div>
                  <div class="flex items-center justify-between pb-2">
                    <button type="submit" class="px-6
      py-2.5
      bg-blue-600
      text-white
      font-medium
      text-xs
      leading-tight
      uppercase
      rounded
      shadow-md
      hover:bg-blue-700 hover:shadow-lg
      focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0
      active:bg-blue-800 active:shadow-lg
      transition
      duration-150
      ease-in-out
      ml-1">Save Book</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </section>
      </div>
      <div
        class="modal-footer flex flex-shrink-0 flex-wrap items-center justify-end p-4 border-t border-gray-200 rounded-b-md">
        <button type="button" class="px-6
          py-2.5
          bg-purple-600
          text-white
          font-medium
          text-xs
          leading-tight
          uppercase
          rounded
          shadow-md
          hover:bg-purple-700 hover:shadow-lg
          focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0
          active:bg-purple-800 active:shadow-lg
          transition
          duration-150
          ease-in-out" data-bs-dismiss="modal">Close</button>
       
      </div>
    </div>
  </div>
</div>


<!-- Modal for update Book-->
<div class="modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto"
  id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog relative w-auto pointer-events-none">
    <div
      class="modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current">
      <div
        class="modal-header flex flex-shrink-0 items-center justify-between p-4 border-b border-gray-200 rounded-t-md">
        <h5 class="text-xl font-medium leading-normal text-gray-800" id="exampleModalLabel">Update Book Here</h5>
        <button type="button"
          class="btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline"
          data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body relative p-4">
        <section class="gradient-form bg-gray-200 ">
          <div class="container py-5 px-6 ">
            <div
              class="flex justify-center items-center flex-wrap  g-6 text-gray-800"
            >
              <div class="md:p-12 md:mx-6 bg-white">
                <div class="text-center">
                  <img
                    class="mx-auto w-48"
                    src="book.jpg"
                    alt="logo"
                  />
                  <h4 class="text-xl font-semibold mt-1 mb-6 pb-1">
                    Welcome To Our Library
                  </h4>
                </div>
                <form id="editBookForm"> 
                  <input
                      type="hidden"
                      id="edit_book_id"
                    />   
                  <div class="mb-4">
                    <input
                      type="text"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="edit_book_name"
                      placeholder="Name"
                    />
                  </div>
                  <div class="mb-4">
                    <input
                      type="text"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="edit_book_title"
                      placeholder="Title"
                    />
                  </div>
                  <div class="mb-4">
                    <input
                      type="text"
                      class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none"
                      id="edit_book_price"
                      placeholder="Price"
                    />
                  </div>
                  <div class="text-center pt-1 mb-12 pb-1">
                 
                  </div>
                  <div class="flex items-center justify-between pb-2">
                    <button type="submit" class="px-6
      py-2.5
      bg-blue-600
      text-white
      font-medium
      text-xs
      leading-tight
      uppercase
      rounded
      shadow-md
      hover:bg-blue-700 hover:shadow-lg
      focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0
      active:bg-blue-800 active:shadow-lg
      transition
      duration-150
      ease-in-out
      ml-1">Update Book</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </section>
      </div>
      <div
        class="modal-footer flex flex-shrink-0 flex-wrap items-center justify-end p-4 border-t border-gray-200 rounded-b-md">
        <button type="button" class="px-6
          py-2.5
          bg-purple-600
          text-white
          font-medium
          text-xs
          leading-tight
          uppercase
          rounded
          shadow-md
          hover:bg-purple-700 hover:shadow-lg
          focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0
          active:bg-purple-800 active:shadow-lg
          transition
          duration-150
          ease-in-out" data-bs-dismiss="modal">Close</button>



          
       
      </div>
    </div>
  </div>
</div>

    


















      <script>
        const token = localStorage.getItem('token');
        const name = localStorage.getItem('fname');
        document.getElementById("name").innerText = name;

        //fetch data from daatabase

        const tbl = document.getElementById("tbl");

        const editForm = document.getElementById("editModal");


        fetch("http://localhost:1212/book")
        .then(resp=>resp.json())
        .then(data=>{
          // let data = [...data1,...data1,...data1]
          const totalBook = data.length;
          document.getElementById("totalBook").innerHTML = totalBook;
          const colors = ["bg-blue-300","bg-purple-300","bg-green-300","bg-yellow-200","bg-red-300"];
          data.map((row,index)=>{
            const tr = document.createElement("tr");
            const name_td = document.createElement("td");
            const title_td = document.createElement("td");
            const price_td = document.createElement("td");
            const action_td = document.createElement("td");

            name_td.innerHTML = row.name;
            
            title_td.innerHTML = row.title;
            price_td.innerHTML = row.price;

            const edit_btn = document.createElement("i");
            edit_btn.classList.add("edit_btn");
            edit_btn.classList.add("fa");
            edit_btn.classList.add("fa-edit");
            edit_btn.classList.add("text-green-600");

            const delete_btn = document.createElement("i");
            delete_btn.classList.add("delete_btn");
            delete_btn.classList.add("fa");
            delete_btn.classList.add("fa-trash");
            delete_btn.classList.add("text-red-600");  
            
            const add_btn = document.createElement("i");
            add_btn.classList.add("add_btn");
            add_btn.classList.add("fa");
            add_btn.classList.add("fa-star");
            add_btn.classList.add("text-blue-600");

            
            edit_btn.onclick = function(){
              edit_btn.setAttribute("data-bs-toggle", "modal");
              edit_btn.setAttribute("data-bs-target", "#editModal");
              
              document.getElementById("edit_book_id").value = row._id;
              document.getElementById("edit_book_name").value = row.name;
              document.getElementById("edit_book_title").value = row.title;
              document.getElementById("edit_book_price").value = row.price;
            
            }

            delete_btn.onclick = function(){
              fetch("http://localhost:1212/book/"+row._id,{
                method: "DELETE"
              })
              
              .then(response => response.json())
              .then(()=>window.location.reload())
            }

            add_btn.onclick = function(){alert();
              fetch("http://localhost:1212/user/issue/"+row._id,{
                method: "POST",
                body: JSON.stringify({
                  id : localStorage.getItem("userId")
                }),
                headers: {
                  "Content-Type": "application/json; charset=utf-8"
                }
                
              })
              
              .then(response => response.json())
              .then(()=>window.location.reload())
            }

            action_td.append(edit_btn);
            action_td.append(delete_btn);
            action_td.append(add_btn);

           action_td.value = row._id;
           
            
            tr.append(name_td);
            tr.append(title_td);
            tr.append(price_td);
            tr.append(action_td);

            tr.classList.add(colors[index%colors.length]);
            tbl.append(tr);
          })
        });


//save book in database

        

        const bookForm = document.getElementById("bookForm");
        bookForm.onsubmit = function(e){
        e.preventDefault();
       
        const book_name = document.getElementById("book_name");
        const book_title = document.getElementById("book_title");
        const book_price = document.getElementById("book_price");
        // alert(book_name);
        

       fetch("http://localhost:1212/book",{
        method: "POST",
        body: JSON.stringify({
          name: book_name.value,
          title: book_title.value,
          price: book_price.value
          
        }),
        headers : {
          "Content-Type": "application/json"
        }
       }).then((resp)=>{
        return resp.json();
       }).then((data)=>{
        alert(data.message);
        // window.location.replace("login.html");
       })

      }



      //delete Books



      //update book in database

      const editBookForm = document.getElementById("editBookForm");
      editBookForm.addEventListener("submit", function(e){
        e.preventDefault();

        const book_id = document.getElementById("edit_book_id").value;
        const book_name = document.getElementById("edit_book_name");
        const book_title = document.getElementById("edit_book_title");
        const book_price = document.getElementById("edit_book_price");

        fetch("http://localhost:1212/book/"+book_id,{
          method: "PUT",
          body: JSON.stringify({
            name: book_name.value,
            title: book_title.value,
            price: book_price.value
          }),
          headers: {
            "Content-Type": "application/json"
          }
          
        }).then((resp)=> resp.json())
        .then(()=>window.location.reload())

      });

      

      

      


      </script>
      <script src="https://cdn.jsdelivr.net/npm/tw-elements/dist/js/index.min.js"></script>
</body>
</html>